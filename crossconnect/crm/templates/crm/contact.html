{% extends 'base/base.html' %}
{% load crm_filters %}

{% block content %}
<div class="contact_header contact_row">
  <p>{{contact.first_name}} {{contact.last_name}}<p>
</div>

<div class="contact_control_bar">
    <input class="int_search search_box" type="text" id="myInput" onkeyup="myFunction()" placeholder="Search.." title="Type in a name">
    <div class="filter">
      <svg style="filter" viewBox="0 0 25 25">
        <path fill="#707070" d="M15,19.88C15.04,20.18 14.94,20.5 14.71,20.71C14.32,21.1 13.69,21.1 13.3,20.71L9.29,16.7C9.06,16.47 8.96,16.16 9,15.87V10.75L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L15,10.75V19.88M7.04,5L11,10.06V15.58L13,17.58V10.05L16.96,5H7.04Z" />
      </svg>
    </div>
</div>

{% for interaction in interactions %}

<!-- TODO: Research template_filters, need to split date into seperate parts for styling -->
  <div class="timeline_year">
    <p> {{ interaction.date|get_year}} <p>
  </div>

  <div class="timeline_month">
    {{ interaction.date|get_month}}
  </div>

  <div class="timeline_day">
    <span class="day">{{ interaction.date|get_day}}</span>
  </div>

  <div class="interaction_card">
      <p>
        <svg style="width:24px;height:24px;margin-top:8px;" viewBox="0 0 24 24">
          <path class="interaction_icon" fill="#000000" d="{{interaction.type|get_interaction_svg }}" />
        </svg>
      </p>
      {% if interaction.notes != None %}
          <hr width="90%">
          <div class="interaction_notes">{{ interaction.notes }}</div>
      {% endif %}
  </div>


{% endfor %}

<a href="http://localhost:8000/Relations/{{ contact.id }}/Add">
<div class="add_button">
<!-- TODO: Finish button-->
</div>
<a>

<script>

  var years, current_year, next_year;
  years = document.getElementsByClassName("timeline_year");
  current_year = years[0].textContent;
  for (i = 1; i < years.length; i++) {
    next_year = years[i].textContent;
    if (next_year == current_year) {
      years[i].style.display = "none";
    }
    else {
      current_year = years[i].textContent;
    }
  }

  var months, current_month, next_month;
  months = document.getElementsByClassName("timeline_month");
  current_month = months[0].textContent;
  for (i = 1; i < months.length; i++) {
    next_month = months[i].textContent;
    if (next_month == current_month) {
      months[i].style.display = "none";
    }
    else {
      current_month = months[i].textContent;
    }
  }

  var days, current_day, next_day;
  days = document.getElementsByClassName("timeline_day");
  current_day = days[0].textContent;
  for (i = 1; i < days.length; i++) {
    next_day = days[i].textContent;
    if (next_day == current_day) {
      days[i].style.display = "none";
    }
    else {
      current_day = days[i].textContent;
    }
  }

</script>

{% endblock %}
